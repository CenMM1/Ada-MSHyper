Args: Namespace(batch_size=64, d_model=128, data_format='pkl', disable_epc=0, dropout=0.1, dynamic_hypergraph=1, ecr_target_kappa=0.0001, ecr_warmup_epochs=10, exclude_oob=1, feature_dim_audio=768, feature_dim_text=768, feature_dim_video=512, hyper_heads=1, hyper_multi_head_attention=0, hyper_num_audio=50, hyper_num_text=20, hyper_num_video=10, hyper_update_freq=5, is_training=1, itr=1, k=3, kappa=0.0001, label_map=7, learning_rate=0.01, loss_lambda=0.1, loss_mode='pos_weight', num_classes=7, num_ordinal_levels=7, num_workers=8, patience=3, pkl_path='./preprocess/mosi_all_feat.pkl', root_path='./datasets', seq_len_audio=500, seq_len_text=44, seq_len_video=32, task_mode='ordinal', train_epochs=10, use_coral=0, use_gpu=True, use_mosi_ecr=0)
Use GPU: cuda
[Info] Number of parameters: 417542
[Info] Dataset: MOSI
[Info] Format: pkl
[Info] Task mode: ordinal
[Info] Label encoding: ordinal (6 thresholds)
[Info] Loss: pos_weight
[Info] Eval metrics: MAE / Corr / ACC7(report only)
[Info] CORAL enabled: False
[Info] MOSI ECR warm-up enabled: False
>>> Start training: MultimodalClassifier_multimodal_dm128_nc7_0 >>>
[Info] Loading train data...
train 1284
[Info] train data loaded: 1284 samples
[Info] Loading val data...
val 229
[Info] val data loaded: 229 samples
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.4871 | Corr: 0.0063
[Info] Vali MAE: 1.3637 | Corr: 0.0112
Epoch: 1, Time: 9.44s | Train Loss: 1.1166131 Vali Loss: 0.6763529 Test Loss: 0.6586547 | Train MAE: 1.4457 Corr: 0.0058
Validation loss decreased (inf --> 0.676353).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.4045 | Corr: 0.0171
[Info] Vali MAE: 1.3646 | Corr: 0.0144
Epoch: 2, Time: 6.98s | Train Loss: 0.6161595 Vali Loss: 0.5724282 Test Loss: 0.5439512 | Train MAE: 1.3477 Corr: 0.0197
Validation loss decreased (0.676353 --> 0.572428).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3673 | Corr: 0.0006
[Info] Vali MAE: 1.4417 | Corr: 0.0115
Epoch: 3, Time: 7.10s | Train Loss: 0.5235400 Vali Loss: 0.5524805 Test Loss: 0.5580323 | Train MAE: 1.3509 Corr: 0.0174
Validation loss decreased (0.572428 --> 0.552480).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.4081 | Corr: 0.0114
[Info] Vali MAE: 1.4565 | Corr: 0.0142
Epoch: 4, Time: 7.06s | Train Loss: 0.5083303 Vali Loss: 0.5386242 Test Loss: 0.5631585 | Train MAE: 1.3373 Corr: 0.0134
Validation loss decreased (0.552480 --> 0.538624).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.4231 | Corr: 0.0325
[Info] Vali MAE: 1.6843 | Corr: 0.0249
Epoch: 5, Time: 6.93s | Train Loss: 0.5109445 Vali Loss: 0.5640924 Test Loss: 0.6897636 | Train MAE: 1.3205 Corr: 0.0257
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3679 | Corr: 0.0198
[Info] Vali MAE: 1.3636 | Corr: 0.0226
Epoch: 6, Time: 7.02s | Train Loss: 0.5150165 Vali Loss: 0.5309381 Test Loss: 0.5171152 | Train MAE: 1.2772 Corr: 0.0274
Validation loss decreased (0.538624 --> 0.530938).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1845 | Corr: 0.0395
[Info] Vali MAE: 1.3457 | Corr: 0.0330
Epoch: 7, Time: 6.95s | Train Loss: 0.4725615 Vali Loss: 0.4811409 Test Loss: 0.5223285 | Train MAE: 1.1912 Corr: 0.0387
Validation loss decreased (0.530938 --> 0.481141).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1845 | Corr: 0.0378
[Info] Vali MAE: 1.2362 | Corr: 0.0368
Epoch: 8, Time: 7.00s | Train Loss: 0.4121067 Vali Loss: 0.5403612 Test Loss: 0.5481540 | Train MAE: 1.0622 Corr: 0.0445
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3459 | Corr: 0.0083
[Info] Vali MAE: 1.5820 | Corr: 0.0091
Epoch: 9, Time: 6.88s | Train Loss: 0.5795541 Vali Loss: 0.5141969 Test Loss: 0.5766867 | Train MAE: 1.3315 Corr: 0.0235
EarlyStopping counter: 2 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3011 | Corr: 0.0337
[Info] Vali MAE: 1.3913 | Corr: 0.0315
Epoch: 10, Time: 6.92s | Train Loss: 0.4814266 Vali Loss: 0.5025193 Test Loss: 0.5202129 | Train MAE: 1.2687 Corr: 0.0272
EarlyStopping counter: 3 out of 3
Early stopping
>>> Testing: MultimodalClassifier_multimodal_dm128_nc7_0 <<<
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
MAE: 1.3453
Corr: 0.1164
ACC7 (report only): 0.2157


/workspace/Ada-MSHyper/utils/metrics.py:34: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.abs((pred - true) / true))
/workspace/Ada-MSHyper/utils/metrics.py:38: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.square((pred - true) / true))

