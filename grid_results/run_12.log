Args: Namespace(attn_pooling_dropout=0.1, batch_size=64, d_model=128, data_format='pkl', disable_epc=0, dropout=0.1, dynamic_hypergraph=1, ecr_target_kappa=0.0001, ecr_warmup_epochs=10, exclude_oob=1, feature_dim_audio=768, feature_dim_text=768, feature_dim_video=512, hyper_heads=1, hyper_multi_head_attention=0, hyper_num_audio=50, hyper_num_text=30, hyper_num_video=20, hyper_tau=0.5, hyper_topk=3, hyper_update_freq=5, is_training=1, itr=1, k=3, kappa=0.0, label_map=7, learning_rate=0.0003, loss_lambda=0.1, loss_mode='bce', num_classes=7, num_ordinal_levels=7, num_workers=8, patience=3, pkl_path='./preprocess/mosi_all_feat.pkl', reg_huber_delta=1.0, reg_loss_type='mae', reg_loss_weight=0.05, root_path='./datasets', seq_len_audio=500, seq_len_text=44, seq_len_video=32, setting_suffix='run12', task_mode='regression', train_epochs=10, use_attn_pooling=1, use_coral=0, use_gpu=True, use_head_ln=0, use_modal_gate=1, use_mosi_ecr=0, weight_decay=1e-05)
Use GPU: cuda
[Info] Number of parameters: 450050
[Info] Dataset: MOSI
[Info] Format: pkl
[Info] Task mode: regression
[Info] Loss: mae
[Info] Eval metrics: MAE / Corr / ACC7(report only)
[Info] MOSI ECR warm-up enabled: False
>>> Start training: MultimodalClassifier_multimodal_dm128_nc7_0_run12 >>>
[Info] Loading train data...
train 1284
[Info] train data loaded: 1284 samples
[Info] Loading val data...
val 229
[Info] val data loaded: 229 samples
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3888 | Corr: 0.3028
[Info] Vali MAE: 1.4706 | Corr: 0.0200
Epoch: 1, Time: 11.09s | Train Loss: 0.8787464 Vali Loss: 0.9499955 Test Loss: 1.0248923 | Train MAE: 1.3165 Corr: 0.1897
Validation loss decreased (inf --> 0.949996).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3476 | Corr: 0.3102
[Info] Vali MAE: 1.4741 | Corr: 0.1901
Epoch: 2, Time: 7.95s | Train Loss: 0.8580719 Vali Loss: 0.9133712 Test Loss: 1.0311117 | Train MAE: 1.2983 Corr: 0.2172
Validation loss decreased (0.949996 --> 0.913371).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3482 | Corr: 0.3506
[Info] Vali MAE: 1.3747 | Corr: 0.3970
Epoch: 3, Time: 8.02s | Train Loss: 0.8098192 Vali Loss: 0.9183147 Test Loss: 0.9339759 | Train MAE: 1.2422 Corr: 0.3426
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.2254 | Corr: 0.4155
[Info] Vali MAE: 1.2543 | Corr: 0.4709
Epoch: 4, Time: 8.16s | Train Loss: 0.7249211 Vali Loss: 0.8134996 Test Loss: 0.8321270 | Train MAE: 1.1473 Corr: 0.4472
Validation loss decreased (0.913371 --> 0.813500).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1551 | Corr: 0.5174
[Info] Vali MAE: 1.2229 | Corr: 0.5163
Epoch: 5, Time: 8.20s | Train Loss: 0.6627657 Vali Loss: 0.7496568 Test Loss: 0.8021379 | Train MAE: 1.0754 Corr: 0.5288
Validation loss decreased (0.813500 --> 0.749657).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1828 | Corr: 0.5207
[Info] Vali MAE: 1.2192 | Corr: 0.5127
Epoch: 6, Time: 8.12s | Train Loss: 0.6273197 Vali Loss: 0.7635196 Test Loss: 0.7975065 | Train MAE: 1.0329 Corr: 0.5778
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1192 | Corr: 0.5692
[Info] Vali MAE: 1.1216 | Corr: 0.5257
Epoch: 7, Time: 8.19s | Train Loss: 0.5804326 Vali Loss: 0.7017648 Test Loss: 0.7127926 | Train MAE: 0.9813 Corr: 0.6262
Validation loss decreased (0.749657 --> 0.701765).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0642 | Corr: 0.6003
[Info] Vali MAE: 1.1445 | Corr: 0.5531
Epoch: 8, Time: 8.11s | Train Loss: 0.5342091 Vali Loss: 0.6657292 Test Loss: 0.7305009 | Train MAE: 0.9176 Corr: 0.6521
Validation loss decreased (0.701765 --> 0.665729).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0511 | Corr: 0.6201
[Info] Vali MAE: 1.1192 | Corr: 0.5326
Epoch: 9, Time: 7.91s | Train Loss: 0.4925240 Vali Loss: 0.6499038 Test Loss: 0.7187936 | Train MAE: 0.8754 Corr: 0.6917
Validation loss decreased (0.665729 --> 0.649904).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0580 | Corr: 0.6296
[Info] Vali MAE: 1.0649 | Corr: 0.5610
Epoch: 10, Time: 7.95s | Train Loss: 0.5263266 Vali Loss: 0.6516049 Test Loss: 0.6662812 | Train MAE: 0.9113 Corr: 0.6586
EarlyStopping counter: 1 out of 3
>>> Testing: MultimodalClassifier_multimodal_dm128_nc7_0_run12 <<<
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
MAE: 1.1345
Corr: 0.5052
ACC7 (report only): 0.2901


/workspace/Ada-MSHyper/utils/metrics.py:28: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.abs((pred - true) / true))
/workspace/Ada-MSHyper/utils/metrics.py:32: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.square((pred - true) / true))

