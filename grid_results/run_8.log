Args: Namespace(attn_pooling_dropout=0.1, batch_size=64, d_model=128, data_format='pkl', disable_epc=0, dropout=0.1, dynamic_hypergraph=1, ecr_target_kappa=0.0001, ecr_warmup_epochs=10, exclude_oob=1, feature_dim_audio=768, feature_dim_text=768, feature_dim_video=512, hyper_heads=1, hyper_multi_head_attention=0, hyper_num_audio=50, hyper_num_text=30, hyper_num_video=20, hyper_tau=0.5, hyper_topk=3, hyper_update_freq=5, is_training=1, itr=1, k=3, kappa=0.0, label_map=7, learning_rate=0.001, loss_lambda=0.1, loss_mode='bce', num_classes=7, num_ordinal_levels=7, num_workers=8, patience=3, pkl_path='./preprocess/mosi_all_feat.pkl', reg_huber_delta=1.0, reg_loss_type='mae', reg_loss_weight=0.05, root_path='./datasets', seq_len_audio=500, seq_len_text=44, seq_len_video=32, setting_suffix='run8', task_mode='regression', train_epochs=10, use_attn_pooling=1, use_coral=0, use_gpu=True, use_head_ln=0, use_modal_gate=1, use_mosi_ecr=0, weight_decay=1e-05)
Use GPU: cuda
[Info] Number of parameters: 450050
[Info] Dataset: MOSI
[Info] Format: pkl
[Info] Task mode: regression
[Info] Loss: mae
[Info] Eval metrics: MAE / Corr / ACC7(report only)
[Info] MOSI ECR warm-up enabled: False
>>> Start training: MultimodalClassifier_multimodal_dm128_nc7_0_run8 >>>
[Info] Loading train data...
train 1284
[Info] train data loaded: 1284 samples
[Info] Loading val data...
val 229
[Info] val data loaded: 229 samples
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.2744 | Corr: 0.4427
[Info] Vali MAE: 1.3369 | Corr: 0.2547
Epoch: 1, Time: 10.74s | Train Loss: 0.8497072 Vali Loss: 0.8434648 Test Loss: 0.9041223 | Train MAE: 1.2882 Corr: 0.2330
Validation loss decreased (inf --> 0.843465).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.2033 | Corr: 0.5173
[Info] Vali MAE: 1.2221 | Corr: 0.4876
Epoch: 2, Time: 7.73s | Train Loss: 0.7408382 Vali Loss: 0.7863929 Test Loss: 0.8000884 | Train MAE: 1.1649 Corr: 0.4671
Validation loss decreased (0.843465 --> 0.786393).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0918 | Corr: 0.6050
[Info] Vali MAE: 1.1551 | Corr: 0.5161
Epoch: 3, Time: 7.77s | Train Loss: 0.6144244 Vali Loss: 0.6769146 Test Loss: 0.7531523 | Train MAE: 1.0181 Corr: 0.5817
Validation loss decreased (0.786393 --> 0.676915).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0808 | Corr: 0.6251
[Info] Vali MAE: 1.1687 | Corr: 0.5421
Epoch: 4, Time: 7.65s | Train Loss: 0.5778550 Vali Loss: 0.6760416 Test Loss: 0.7582550 | Train MAE: 0.9771 Corr: 0.6365
Validation loss decreased (0.676915 --> 0.676042).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0977 | Corr: 0.6377
[Info] Vali MAE: 1.0531 | Corr: 0.5943
Epoch: 5, Time: 7.54s | Train Loss: 0.5258761 Vali Loss: 0.6837788 Test Loss: 0.6464049 | Train MAE: 0.9129 Corr: 0.6627
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1439 | Corr: 0.5894
[Info] Vali MAE: 1.0157 | Corr: 0.6147
Epoch: 6, Time: 7.71s | Train Loss: 0.5134153 Vali Loss: 0.7127354 Test Loss: 0.6138502 | Train MAE: 0.8937 Corr: 0.6856
EarlyStopping counter: 2 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9491 | Corr: 0.6944
[Info] Vali MAE: 0.9928 | Corr: 0.6288
Epoch: 7, Time: 7.80s | Train Loss: 0.4830510 Vali Loss: 0.5666143 Test Loss: 0.6015438 | Train MAE: 0.8586 Corr: 0.7087
Validation loss decreased (0.676042 --> 0.566614).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9759 | Corr: 0.6497
[Info] Vali MAE: 1.0744 | Corr: 0.6278
Epoch: 8, Time: 7.59s | Train Loss: 0.4469099 Vali Loss: 0.5924551 Test Loss: 0.6706947 | Train MAE: 0.8156 Corr: 0.7224
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0005 | Corr: 0.6797
[Info] Vali MAE: 1.0186 | Corr: 0.6343
Epoch: 9, Time: 7.52s | Train Loss: 0.4356448 Vali Loss: 0.6008446 Test Loss: 0.6189281 | Train MAE: 0.8002 Corr: 0.7359
EarlyStopping counter: 2 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9601 | Corr: 0.6774
[Info] Vali MAE: 0.9794 | Corr: 0.6329
Epoch: 10, Time: 7.69s | Train Loss: 0.4008021 Vali Loss: 0.5704548 Test Loss: 0.5907701 | Train MAE: 0.7608 Corr: 0.7683
EarlyStopping counter: 3 out of 3
Early stopping
>>> Testing: MultimodalClassifier_multimodal_dm128_nc7_0_run8 <<<
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
MAE: 1.0148
Corr: 0.6102
ACC7 (report only): 0.3076


/workspace/Ada-MSHyper/utils/metrics.py:28: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.abs((pred - true) / true))
/workspace/Ada-MSHyper/utils/metrics.py:32: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.square((pred - true) / true))

