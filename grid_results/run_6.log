Args: Namespace(attn_pooling_dropout=0.1, batch_size=64, d_model=128, data_format='pkl', disable_epc=0, dropout=0.1, dynamic_hypergraph=1, ecr_target_kappa=0.0001, ecr_warmup_epochs=10, exclude_oob=1, feature_dim_audio=768, feature_dim_text=768, feature_dim_video=512, hyper_heads=1, hyper_multi_head_attention=0, hyper_num_audio=30, hyper_num_text=20, hyper_num_video=10, hyper_tau=0.5, hyper_topk=3, hyper_update_freq=5, is_training=1, itr=1, k=3, kappa=0.0, label_map=7, learning_rate=0.001, loss_lambda=0.1, loss_mode='bce', num_classes=7, num_ordinal_levels=7, num_workers=8, patience=3, pkl_path='./preprocess/mosi_all_feat.pkl', reg_huber_delta=1.0, reg_loss_type='mae', reg_loss_weight=0.05, root_path='./datasets', seq_len_audio=500, seq_len_text=44, seq_len_video=32, setting_suffix='run6', task_mode='regression', train_epochs=10, use_attn_pooling=1, use_coral=0, use_gpu=True, use_head_ln=0, use_modal_gate=1, use_mosi_ecr=0, weight_decay=1e-05)
Use GPU: cuda
[Info] Number of parameters: 444930
[Info] Dataset: MOSI
[Info] Format: pkl
[Info] Task mode: regression
[Info] Loss: mae
[Info] Eval metrics: MAE / Corr / ACC7(report only)
[Info] MOSI ECR warm-up enabled: False
>>> Start training: MultimodalClassifier_multimodal_dm128_nc7_0_run6 >>>
[Info] Loading train data...
train 1284
[Info] train data loaded: 1284 samples
[Info] Loading val data...
val 229
[Info] val data loaded: 229 samples
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.4369 | Corr: 0.3489
[Info] Vali MAE: 1.4620 | Corr: 0.0370
Epoch: 1, Time: 10.48s | Train Loss: 0.8781024 Vali Loss: 0.9988524 Test Loss: 1.0159047 | Train MAE: 1.3197 Corr: 0.1497
Validation loss decreased (inf --> 0.998852).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3436 | Corr: 0.4809
[Info] Vali MAE: 1.4193 | Corr: 0.2732
Epoch: 2, Time: 7.56s | Train Loss: 0.8591954 Vali Loss: 0.9094074 Test Loss: 0.9778516 | Train MAE: 1.2989 Corr: 0.2574
Validation loss decreased (0.998852 --> 0.909407).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.2917 | Corr: 0.4117
[Info] Vali MAE: 1.3346 | Corr: 0.3939
Epoch: 3, Time: 7.53s | Train Loss: 0.7683066 Vali Loss: 0.8730578 Test Loss: 0.8972345 | Train MAE: 1.1982 Corr: 0.4112
Validation loss decreased (0.909407 --> 0.873058).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1863 | Corr: 0.5147
[Info] Vali MAE: 1.1821 | Corr: 0.5115
Epoch: 4, Time: 7.50s | Train Loss: 0.6729148 Vali Loss: 0.7688383 Test Loss: 0.7670068 | Train MAE: 1.0855 Corr: 0.5322
Validation loss decreased (0.873058 --> 0.768838).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1305 | Corr: 0.6214
[Info] Vali MAE: 1.1089 | Corr: 0.5305
Epoch: 5, Time: 7.22s | Train Loss: 0.6129590 Vali Loss: 0.7079422 Test Loss: 0.7021537 | Train MAE: 1.0221 Corr: 0.5967
Validation loss decreased (0.768838 --> 0.707942).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0385 | Corr: 0.6381
[Info] Vali MAE: 1.1495 | Corr: 0.5902
Epoch: 6, Time: 7.41s | Train Loss: 0.5358993 Vali Loss: 0.6460688 Test Loss: 0.7351022 | Train MAE: 0.9312 Corr: 0.6595
Validation loss decreased (0.707942 --> 0.646069).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1021 | Corr: 0.5729
[Info] Vali MAE: 1.0976 | Corr: 0.5824
Epoch: 7, Time: 7.54s | Train Loss: 0.4715082 Vali Loss: 0.6924078 Test Loss: 0.6847723 | Train MAE: 0.8437 Corr: 0.7072
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0744 | Corr: 0.5946
[Info] Vali MAE: 1.1204 | Corr: 0.5974
Epoch: 8, Time: 7.44s | Train Loss: 0.4356862 Vali Loss: 0.6716387 Test Loss: 0.7063098 | Train MAE: 0.7990 Corr: 0.7367
EarlyStopping counter: 2 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0583 | Corr: 0.5960
[Info] Vali MAE: 1.0877 | Corr: 0.6027
Epoch: 9, Time: 7.48s | Train Loss: 0.4311809 Vali Loss: 0.6537744 Test Loss: 0.6801686 | Train MAE: 0.7924 Corr: 0.7531
EarlyStopping counter: 3 out of 3
Early stopping
>>> Testing: MultimodalClassifier_multimodal_dm128_nc7_0_run6 <<<
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
MAE: 1.1525
Corr: 0.5874
ACC7 (report only): 0.2624


/workspace/Ada-MSHyper/utils/metrics.py:28: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.abs((pred - true) / true))
/workspace/Ada-MSHyper/utils/metrics.py:32: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.square((pred - true) / true))

