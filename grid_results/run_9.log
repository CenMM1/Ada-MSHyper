Args: Namespace(attn_pooling_dropout=0.1, batch_size=64, d_model=128, data_format='pkl', disable_epc=0, dropout=0.1, dynamic_hypergraph=1, ecr_target_kappa=0.0001, ecr_warmup_epochs=10, exclude_oob=1, feature_dim_audio=768, feature_dim_text=768, feature_dim_video=512, hyper_heads=1, hyper_multi_head_attention=0, hyper_num_audio=30, hyper_num_text=20, hyper_num_video=10, hyper_tau=0.5, hyper_topk=3, hyper_update_freq=5, is_training=1, itr=1, k=3, kappa=0.0, label_map=7, learning_rate=0.0003, loss_lambda=0.1, loss_mode='bce', num_classes=7, num_ordinal_levels=7, num_workers=8, patience=3, pkl_path='./preprocess/mosi_all_feat.pkl', reg_huber_delta=1.0, reg_loss_type='mae', reg_loss_weight=0.05, root_path='./datasets', seq_len_audio=500, seq_len_text=44, seq_len_video=32, setting_suffix='run9', task_mode='regression', train_epochs=10, use_attn_pooling=0, use_coral=0, use_gpu=True, use_head_ln=0, use_modal_gate=1, use_mosi_ecr=0, weight_decay=1e-05)
Use GPU: cuda
[Info] Number of parameters: 444162
[Info] Dataset: MOSI
[Info] Format: pkl
[Info] Task mode: regression
[Info] Loss: mae
[Info] Eval metrics: MAE / Corr / ACC7(report only)
[Info] MOSI ECR warm-up enabled: False
>>> Start training: MultimodalClassifier_multimodal_dm128_nc7_0_run9 >>>
[Info] Loading train data...
train 1284
[Info] train data loaded: 1284 samples
[Info] Loading val data...
val 229
[Info] val data loaded: 229 samples
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3508 | Corr: 0.4124
[Info] Vali MAE: 1.4908 | Corr: -0.1450
Epoch: 1, Time: 10.31s | Train Loss: 0.8763237 Vali Loss: 0.9118052 Test Loss: 1.0458366 | Train MAE: 1.3155 Corr: 0.1111
Validation loss decreased (inf --> 0.911805).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.4219 | Corr: 0.4544
[Info] Vali MAE: 1.4431 | Corr: 0.0709
Epoch: 2, Time: 7.64s | Train Loss: 0.8636981 Vali Loss: 0.9809427 Test Loss: 0.9977941 | Train MAE: 1.3063 Corr: 0.1386
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.2913 | Corr: 0.4506
[Info] Vali MAE: 1.3571 | Corr: 0.3276
Epoch: 3, Time: 7.69s | Train Loss: 0.8097960 Vali Loss: 0.8732485 Test Loss: 0.9146302 | Train MAE: 1.2394 Corr: 0.3776
Validation loss decreased (0.911805 --> 0.873248).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1630 | Corr: 0.5496
[Info] Vali MAE: 1.3012 | Corr: 0.4375
Epoch: 4, Time: 7.77s | Train Loss: 0.7524486 Vali Loss: 0.7494480 Test Loss: 0.8765460 | Train MAE: 1.1765 Corr: 0.4362
Validation loss decreased (0.873248 --> 0.749448).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1422 | Corr: 0.5745
[Info] Vali MAE: 1.1447 | Corr: 0.5072
Epoch: 5, Time: 7.69s | Train Loss: 0.6587754 Vali Loss: 0.7374725 Test Loss: 0.7307792 | Train MAE: 1.0684 Corr: 0.5367
Validation loss decreased (0.749448 --> 0.737473).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1663 | Corr: 0.5972
[Info] Vali MAE: 1.1733 | Corr: 0.4958
Epoch: 6, Time: 7.59s | Train Loss: 0.6083769 Vali Loss: 0.7442170 Test Loss: 0.7622363 | Train MAE: 1.0061 Corr: 0.5866
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.2250 | Corr: 0.5631
[Info] Vali MAE: 1.1967 | Corr: 0.5492
Epoch: 7, Time: 7.90s | Train Loss: 0.8302171 Vali Loss: 0.8001937 Test Loss: 0.7632831 | Train MAE: 1.2421 Corr: 0.5613
EarlyStopping counter: 2 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0918 | Corr: 0.5776
[Info] Vali MAE: 1.1199 | Corr: 0.5841
Epoch: 8, Time: 7.69s | Train Loss: 0.5956625 Vali Loss: 0.6818072 Test Loss: 0.7001143 | Train MAE: 0.9926 Corr: 0.6102
Validation loss decreased (0.737473 --> 0.681807).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0723 | Corr: 0.6282
[Info] Vali MAE: 1.0797 | Corr: 0.5723
Epoch: 9, Time: 7.61s | Train Loss: 0.5532509 Vali Loss: 0.6590034 Test Loss: 0.6686001 | Train MAE: 0.9458 Corr: 0.6494
Validation loss decreased (0.681807 --> 0.659003).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0951 | Corr: 0.5897
[Info] Vali MAE: 1.0238 | Corr: 0.6162
Epoch: 10, Time: 7.65s | Train Loss: 0.5090358 Vali Loss: 0.6919526 Test Loss: 0.6194458 | Train MAE: 0.8913 Corr: 0.6657
EarlyStopping counter: 1 out of 3
>>> Testing: MultimodalClassifier_multimodal_dm128_nc7_0_run9 <<<
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
MAE: 1.0931
Corr: 0.5788
ACC7 (report only): 0.2799


/workspace/Ada-MSHyper/utils/metrics.py:28: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.abs((pred - true) / true))
/workspace/Ada-MSHyper/utils/metrics.py:32: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.square((pred - true) / true))

