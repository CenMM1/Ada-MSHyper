Args: Namespace(attn_pooling_dropout=0.1, batch_size=64, d_model=128, data_format='pkl', disable_epc=0, dropout=0.1, dynamic_hypergraph=1, ecr_target_kappa=0.0001, ecr_warmup_epochs=10, exclude_oob=1, feature_dim_audio=768, feature_dim_text=768, feature_dim_video=512, hyper_heads=1, hyper_multi_head_attention=0, hyper_num_audio=30, hyper_num_text=20, hyper_num_video=10, hyper_tau=0.5, hyper_topk=3, hyper_update_freq=5, is_training=1, itr=1, k=3, kappa=0.0, label_map=7, learning_rate=0.003, loss_lambda=0.1, loss_mode='bce', num_classes=7, num_ordinal_levels=7, num_workers=8, patience=3, pkl_path='./preprocess/mosi_all_feat.pkl', reg_huber_delta=1.0, reg_loss_type='mae', reg_loss_weight=0.05, root_path='./datasets', seq_len_audio=500, seq_len_text=44, seq_len_video=32, setting_suffix='run2', task_mode='regression', train_epochs=10, use_attn_pooling=1, use_coral=0, use_gpu=True, use_head_ln=0, use_modal_gate=1, use_mosi_ecr=0, weight_decay=1e-05)
Use GPU: cuda
[Info] Number of parameters: 444930
[Info] Dataset: MOSI
[Info] Format: pkl
[Info] Task mode: regression
[Info] Loss: mae
[Info] Eval metrics: MAE / Corr / ACC7(report only)
[Info] MOSI ECR warm-up enabled: False
>>> Start training: MultimodalClassifier_multimodal_dm128_nc7_0_run2 >>>
[Info] Loading train data...
train 1284
[Info] train data loaded: 1284 samples
[Info] Loading val data...
val 229
[Info] val data loaded: 229 samples
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3308 | Corr: 0.4617
[Info] Vali MAE: 1.4099 | Corr: 0.3685
Epoch: 1, Time: 10.45s | Train Loss: 0.9465278 Vali Loss: 0.8999729 Test Loss: 0.9653229 | Train MAE: 1.3875 Corr: 0.2243
Validation loss decreased (inf --> 0.899973).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1564 | Corr: 0.5353
[Info] Vali MAE: 1.1741 | Corr: 0.4992
Epoch: 2, Time: 6.86s | Train Loss: 0.7594103 Vali Loss: 0.7456257 Test Loss: 0.7578864 | Train MAE: 1.1827 Corr: 0.4313
Validation loss decreased (0.899973 --> 0.745626).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0568 | Corr: 0.6189
[Info] Vali MAE: 1.1739 | Corr: 0.5712
Epoch: 3, Time: 6.86s | Train Loss: 0.5933511 Vali Loss: 0.6593089 Test Loss: 0.7530738 | Train MAE: 0.9889 Corr: 0.6115
Validation loss decreased (0.745626 --> 0.659309).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1050 | Corr: 0.6073
[Info] Vali MAE: 1.0876 | Corr: 0.5919
Epoch: 4, Time: 6.97s | Train Loss: 0.5460512 Vali Loss: 0.6922122 Test Loss: 0.6768503 | Train MAE: 0.9374 Corr: 0.6511
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0152 | Corr: 0.6663
[Info] Vali MAE: 1.0481 | Corr: 0.5978
Epoch: 5, Time: 7.04s | Train Loss: 0.4878909 Vali Loss: 0.6138107 Test Loss: 0.6434287 | Train MAE: 0.8656 Corr: 0.7108
Validation loss decreased (0.659309 --> 0.613811).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9936 | Corr: 0.6399
[Info] Vali MAE: 1.0478 | Corr: 0.6029
Epoch: 6, Time: 7.06s | Train Loss: 0.4630548 Vali Loss: 0.6001930 Test Loss: 0.6380762 | Train MAE: 0.8321 Corr: 0.7085
Validation loss decreased (0.613811 --> 0.600193).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9321 | Corr: 0.6766
[Info] Vali MAE: 1.0417 | Corr: 0.6040
Epoch: 7, Time: 7.02s | Train Loss: 0.4113175 Vali Loss: 0.5636623 Test Loss: 0.6404352 | Train MAE: 0.7756 Corr: 0.7526
Validation loss decreased (0.600193 --> 0.563662).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0639 | Corr: 0.6680
[Info] Vali MAE: 1.0077 | Corr: 0.5979
Epoch: 8, Time: 7.12s | Train Loss: 0.4219502 Vali Loss: 0.6580793 Test Loss: 0.6193295 | Train MAE: 0.7844 Corr: 0.7587
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0579 | Corr: 0.6538
[Info] Vali MAE: 1.2605 | Corr: 0.6089
Epoch: 9, Time: 7.04s | Train Loss: 0.3924042 Vali Loss: 0.6699618 Test Loss: 0.8324891 | Train MAE: 0.7521 Corr: 0.7795
EarlyStopping counter: 2 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9620 | Corr: 0.6722
[Info] Vali MAE: 1.0340 | Corr: 0.6170
Epoch: 10, Time: 6.91s | Train Loss: 0.3516877 Vali Loss: 0.5701599 Test Loss: 0.6319826 | Train MAE: 0.7049 Corr: 0.8021
EarlyStopping counter: 3 out of 3
Early stopping
>>> Testing: MultimodalClassifier_multimodal_dm128_nc7_0_run2 <<<
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
MAE: 1.0449
Corr: 0.6109
ACC7 (report only): 0.3047


/workspace/Ada-MSHyper/utils/metrics.py:28: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.abs((pred - true) / true))
/workspace/Ada-MSHyper/utils/metrics.py:32: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.square((pred - true) / true))

