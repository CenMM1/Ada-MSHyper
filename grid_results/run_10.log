Args: Namespace(attn_pooling_dropout=0.1, batch_size=64, d_model=128, data_format='pkl', disable_epc=0, dropout=0.1, dynamic_hypergraph=1, ecr_target_kappa=0.0001, ecr_warmup_epochs=10, exclude_oob=1, feature_dim_audio=768, feature_dim_text=768, feature_dim_video=512, hyper_heads=1, hyper_multi_head_attention=0, hyper_num_audio=30, hyper_num_text=20, hyper_num_video=10, hyper_tau=0.5, hyper_topk=3, hyper_update_freq=5, is_training=1, itr=1, k=3, kappa=0.0, label_map=7, learning_rate=0.0003, loss_lambda=0.1, loss_mode='bce', num_classes=7, num_ordinal_levels=7, num_workers=8, patience=3, pkl_path='./preprocess/mosi_all_feat.pkl', reg_huber_delta=1.0, reg_loss_type='mae', reg_loss_weight=0.05, root_path='./datasets', seq_len_audio=500, seq_len_text=44, seq_len_video=32, setting_suffix='run10', task_mode='regression', train_epochs=10, use_attn_pooling=1, use_coral=0, use_gpu=True, use_head_ln=0, use_modal_gate=1, use_mosi_ecr=0, weight_decay=1e-05)
Use GPU: cuda
[Info] Number of parameters: 444930
[Info] Dataset: MOSI
[Info] Format: pkl
[Info] Task mode: regression
[Info] Loss: mae
[Info] Eval metrics: MAE / Corr / ACC7(report only)
[Info] MOSI ECR warm-up enabled: False
>>> Start training: MultimodalClassifier_multimodal_dm128_nc7_0_run10 >>>
[Info] Loading train data...
train 1284
[Info] train data loaded: 1284 samples
[Info] Loading val data...
val 229
[Info] val data loaded: 229 samples
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.4368 | Corr: 0.3806
[Info] Vali MAE: 1.4988 | Corr: -0.0400
Epoch: 1, Time: 9.95s | Train Loss: 0.8726989 Vali Loss: 0.9934108 Test Loss: 1.0539393 | Train MAE: 1.3125 Corr: 0.1346
Validation loss decreased (inf --> 0.993411).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3171 | Corr: 0.3558
[Info] Vali MAE: 1.4637 | Corr: 0.2275
Epoch: 2, Time: 7.91s | Train Loss: 0.8489556 Vali Loss: 0.8883899 Test Loss: 1.0215952 | Train MAE: 1.2871 Corr: 0.2414
Validation loss decreased (0.993411 --> 0.888390).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.3124 | Corr: 0.3445
[Info] Vali MAE: 1.3700 | Corr: 0.3423
Epoch: 3, Time: 7.73s | Train Loss: 0.7981906 Vali Loss: 0.8921781 Test Loss: 0.9286844 | Train MAE: 1.2312 Corr: 0.3508
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1807 | Corr: 0.5246
[Info] Vali MAE: 1.2739 | Corr: 0.4340
Epoch: 4, Time: 7.75s | Train Loss: 0.7073178 Vali Loss: 0.7647519 Test Loss: 0.8448959 | Train MAE: 1.1251 Corr: 0.4658
Validation loss decreased (0.888390 --> 0.764752).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1242 | Corr: 0.5850
[Info] Vali MAE: 1.1782 | Corr: 0.4831
Epoch: 5, Time: 7.59s | Train Loss: 0.6381435 Vali Loss: 0.7127535 Test Loss: 0.7637095 | Train MAE: 1.0455 Corr: 0.5592
Validation loss decreased (0.764752 --> 0.712753).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1088 | Corr: 0.5794
[Info] Vali MAE: 1.3300 | Corr: 0.4287
Epoch: 6, Time: 7.58s | Train Loss: 0.6017551 Vali Loss: 0.7065098 Test Loss: 0.9065186 | Train MAE: 1.0021 Corr: 0.5994
Validation loss decreased (0.712753 --> 0.706510).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0687 | Corr: 0.6306
[Info] Vali MAE: 1.0967 | Corr: 0.5620
Epoch: 7, Time: 7.82s | Train Loss: 0.5733747 Vali Loss: 0.6487932 Test Loss: 0.6837941 | Train MAE: 0.9716 Corr: 0.6339
Validation loss decreased (0.706510 --> 0.648793).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1202 | Corr: 0.6156
[Info] Vali MAE: 1.0613 | Corr: 0.5771
Epoch: 8, Time: 7.67s | Train Loss: 0.5595802 Vali Loss: 0.6948997 Test Loss: 0.6536276 | Train MAE: 0.9549 Corr: 0.6506
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0128 | Corr: 0.6415
[Info] Vali MAE: 1.0647 | Corr: 0.5725
Epoch: 9, Time: 7.89s | Train Loss: 0.5235740 Vali Loss: 0.6190609 Test Loss: 0.6613277 | Train MAE: 0.9042 Corr: 0.6640
Validation loss decreased (0.648793 --> 0.619061).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0300 | Corr: 0.6184
[Info] Vali MAE: 1.0563 | Corr: 0.5765
Epoch: 10, Time: 7.85s | Train Loss: 0.4829922 Vali Loss: 0.6316068 Test Loss: 0.6572438 | Train MAE: 0.8597 Corr: 0.6838
EarlyStopping counter: 1 out of 3
>>> Testing: MultimodalClassifier_multimodal_dm128_nc7_0_run10 <<<
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
MAE: 1.1344
Corr: 0.5263
ACC7 (report only): 0.2638


/workspace/Ada-MSHyper/utils/metrics.py:28: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.abs((pred - true) / true))
/workspace/Ada-MSHyper/utils/metrics.py:32: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.square((pred - true) / true))

