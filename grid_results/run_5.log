Args: Namespace(attn_pooling_dropout=0.1, batch_size=64, d_model=128, data_format='pkl', disable_epc=0, dropout=0.1, dynamic_hypergraph=1, ecr_target_kappa=0.0001, ecr_warmup_epochs=10, exclude_oob=1, feature_dim_audio=768, feature_dim_text=768, feature_dim_video=512, hyper_heads=1, hyper_multi_head_attention=0, hyper_num_audio=30, hyper_num_text=20, hyper_num_video=10, hyper_tau=0.5, hyper_topk=3, hyper_update_freq=5, is_training=1, itr=1, k=3, kappa=0.0, label_map=7, learning_rate=0.001, loss_lambda=0.1, loss_mode='bce', num_classes=7, num_ordinal_levels=7, num_workers=8, patience=3, pkl_path='./preprocess/mosi_all_feat.pkl', reg_huber_delta=1.0, reg_loss_type='mae', reg_loss_weight=0.05, root_path='./datasets', seq_len_audio=500, seq_len_text=44, seq_len_video=32, setting_suffix='run5', task_mode='regression', train_epochs=10, use_attn_pooling=0, use_coral=0, use_gpu=True, use_head_ln=0, use_modal_gate=1, use_mosi_ecr=0, weight_decay=1e-05)
Use GPU: cuda
[Info] Number of parameters: 444162
[Info] Dataset: MOSI
[Info] Format: pkl
[Info] Task mode: regression
[Info] Loss: mae
[Info] Eval metrics: MAE / Corr / ACC7(report only)
[Info] MOSI ECR warm-up enabled: False
>>> Start training: MultimodalClassifier_multimodal_dm128_nc7_0_run5 >>>
[Info] Loading train data...
train 1284
[Info] train data loaded: 1284 samples
[Info] Loading val data...
val 229
[Info] val data loaded: 229 samples
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.2809 | Corr: 0.4528
[Info] Vali MAE: 1.4577 | Corr: 0.1387
Epoch: 1, Time: 9.96s | Train Loss: 0.8594889 Vali Loss: 0.8451033 Test Loss: 1.0179729 | Train MAE: 1.2998 Corr: 0.2029
Validation loss decreased (inf --> 0.845103).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1320 | Corr: 0.5143
[Info] Vali MAE: 1.2337 | Corr: 0.4079
Epoch: 2, Time: 7.20s | Train Loss: 0.7307070 Vali Loss: 0.7186613 Test Loss: 0.8137260 | Train MAE: 1.1501 Corr: 0.4181
Validation loss decreased (0.845103 --> 0.718661).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1073 | Corr: 0.6256
[Info] Vali MAE: 1.1908 | Corr: 0.4896
Epoch: 3, Time: 7.37s | Train Loss: 0.6271434 Vali Loss: 0.7041633 Test Loss: 0.7687644 | Train MAE: 1.0286 Corr: 0.5675
Validation loss decreased (0.718661 --> 0.704163).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0102 | Corr: 0.6786
[Info] Vali MAE: 1.0707 | Corr: 0.5522
Epoch: 4, Time: 7.24s | Train Loss: 0.5347882 Vali Loss: 0.6075640 Test Loss: 0.6615480 | Train MAE: 0.9276 Corr: 0.6490
Validation loss decreased (0.704163 --> 0.607564).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9575 | Corr: 0.6909
[Info] Vali MAE: 0.9990 | Corr: 0.5926
Epoch: 5, Time: 7.44s | Train Loss: 0.4905192 Vali Loss: 0.5536870 Test Loss: 0.6033822 | Train MAE: 0.8668 Corr: 0.6860
Validation loss decreased (0.607564 --> 0.553687).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9521 | Corr: 0.6937
[Info] Vali MAE: 1.0274 | Corr: 0.6020
Epoch: 6, Time: 7.12s | Train Loss: 0.4507395 Vali Loss: 0.5445410 Test Loss: 0.6268193 | Train MAE: 0.8221 Corr: 0.7234
Validation loss decreased (0.553687 --> 0.544541).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9917 | Corr: 0.7029
[Info] Vali MAE: 1.0105 | Corr: 0.6245
Epoch: 7, Time: 7.24s | Train Loss: 0.4466467 Vali Loss: 0.5748069 Test Loss: 0.6078820 | Train MAE: 0.8226 Corr: 0.7328
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9671 | Corr: 0.6735
[Info] Vali MAE: 1.0276 | Corr: 0.5973
Epoch: 8, Time: 7.31s | Train Loss: 0.4171209 Vali Loss: 0.5680482 Test Loss: 0.6338384 | Train MAE: 0.7822 Corr: 0.7493
EarlyStopping counter: 2 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9694 | Corr: 0.6743
[Info] Vali MAE: 1.0294 | Corr: 0.6126
Epoch: 9, Time: 7.26s | Train Loss: 0.4006320 Vali Loss: 0.5831189 Test Loss: 0.6364293 | Train MAE: 0.7576 Corr: 0.7582
EarlyStopping counter: 3 out of 3
Early stopping
>>> Testing: MultimodalClassifier_multimodal_dm128_nc7_0_run5 <<<
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
MAE: 1.0320
Corr: 0.6091
ACC7 (report only): 0.2886


/workspace/Ada-MSHyper/utils/metrics.py:28: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.abs((pred - true) / true))
/workspace/Ada-MSHyper/utils/metrics.py:32: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.square((pred - true) / true))

