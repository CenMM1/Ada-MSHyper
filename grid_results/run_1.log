Args: Namespace(attn_pooling_dropout=0.1, batch_size=64, d_model=128, data_format='pkl', disable_epc=0, dropout=0.1, dynamic_hypergraph=1, ecr_target_kappa=0.0001, ecr_warmup_epochs=10, exclude_oob=1, feature_dim_audio=768, feature_dim_text=768, feature_dim_video=512, hyper_heads=1, hyper_multi_head_attention=0, hyper_num_audio=30, hyper_num_text=20, hyper_num_video=10, hyper_tau=0.5, hyper_topk=3, hyper_update_freq=5, is_training=1, itr=1, k=3, kappa=0.0, label_map=7, learning_rate=0.003, loss_lambda=0.1, loss_mode='bce', num_classes=7, num_ordinal_levels=7, num_workers=8, patience=3, pkl_path='./preprocess/mosi_all_feat.pkl', reg_huber_delta=1.0, reg_loss_type='mae', reg_loss_weight=0.05, root_path='./datasets', seq_len_audio=500, seq_len_text=44, seq_len_video=32, setting_suffix='run1', task_mode='regression', train_epochs=10, use_attn_pooling=0, use_coral=0, use_gpu=True, use_head_ln=0, use_modal_gate=1, use_mosi_ecr=0, weight_decay=1e-05)
Use GPU: cuda
[Info] Number of parameters: 444162
[Info] Dataset: MOSI
[Info] Format: pkl
[Info] Task mode: regression
[Info] Loss: mae
[Info] Eval metrics: MAE / Corr / ACC7(report only)
[Info] MOSI ECR warm-up enabled: False
>>> Start training: MultimodalClassifier_multimodal_dm128_nc7_0_run1 >>>
[Info] Loading train data...
train 1284
[Info] train data loaded: 1284 samples
[Info] Loading val data...
val 229
[Info] val data loaded: 229 samples
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.2604 | Corr: 0.4353
[Info] Vali MAE: 1.3722 | Corr: 0.2161
Epoch: 1, Time: 9.93s | Train Loss: 0.8690109 Vali Loss: 0.8374385 Test Loss: 0.9459149 | Train MAE: 1.3059 Corr: 0.1958
Validation loss decreased (inf --> 0.837439).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1394 | Corr: 0.5402
[Info] Vali MAE: 1.3215 | Corr: 0.4734
Epoch: 2, Time: 6.85s | Train Loss: 0.7250101 Vali Loss: 0.7281345 Test Loss: 0.9005561 | Train MAE: 1.1468 Corr: 0.4744
Validation loss decreased (0.837439 --> 0.728135).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0118 | Corr: 0.6629
[Info] Vali MAE: 1.1234 | Corr: 0.5827
Epoch: 3, Time: 6.79s | Train Loss: 0.5387926 Vali Loss: 0.6074449 Test Loss: 0.7239156 | Train MAE: 0.9263 Corr: 0.6564
Validation loss decreased (0.728135 --> 0.607445).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0453 | Corr: 0.6518
[Info] Vali MAE: 1.0958 | Corr: 0.5595
Epoch: 4, Time: 6.83s | Train Loss: 0.4909632 Vali Loss: 0.6327269 Test Loss: 0.7021918 | Train MAE: 0.8774 Corr: 0.7171
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0620 | Corr: 0.6478
[Info] Vali MAE: 1.0105 | Corr: 0.6267
Epoch: 5, Time: 6.98s | Train Loss: 0.4523784 Vali Loss: 0.6673130 Test Loss: 0.6178293 | Train MAE: 0.8249 Corr: 0.7346
EarlyStopping counter: 2 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9876 | Corr: 0.6808
[Info] Vali MAE: 1.0827 | Corr: 0.6196
Epoch: 6, Time: 6.93s | Train Loss: 0.4691151 Vali Loss: 0.5933268 Test Loss: 0.6926366 | Train MAE: 0.8436 Corr: 0.7334
Validation loss decreased (0.607445 --> 0.593327).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0411 | Corr: 0.6141
[Info] Vali MAE: 1.0132 | Corr: 0.6207
Epoch: 7, Time: 6.82s | Train Loss: 0.4415098 Vali Loss: 0.6402113 Test Loss: 0.6233187 | Train MAE: 0.8093 Corr: 0.7609
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0724 | Corr: 0.6335
[Info] Vali MAE: 1.1982 | Corr: 0.5813
Epoch: 8, Time: 6.81s | Train Loss: 0.5736176 Vali Loss: 0.6680809 Test Loss: 0.7828059 | Train MAE: 0.9700 Corr: 0.7170
EarlyStopping counter: 2 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0458 | Corr: 0.6506
[Info] Vali MAE: 1.0916 | Corr: 0.6124
Epoch: 9, Time: 6.76s | Train Loss: 0.4615811 Vali Loss: 0.6540865 Test Loss: 0.6845797 | Train MAE: 0.8428 Corr: 0.7284
EarlyStopping counter: 3 out of 3
Early stopping
>>> Testing: MultimodalClassifier_multimodal_dm128_nc7_0_run1 <<<
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
MAE: 1.0358
Corr: 0.6299
ACC7 (report only): 0.3236


/workspace/Ada-MSHyper/utils/metrics.py:28: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.abs((pred - true) / true))
/workspace/Ada-MSHyper/utils/metrics.py:32: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.square((pred - true) / true))

