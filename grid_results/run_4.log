Args: Namespace(attn_pooling_dropout=0.1, batch_size=64, d_model=128, data_format='pkl', disable_epc=0, dropout=0.1, dynamic_hypergraph=1, ecr_target_kappa=0.0001, ecr_warmup_epochs=10, exclude_oob=1, feature_dim_audio=768, feature_dim_text=768, feature_dim_video=512, hyper_heads=1, hyper_multi_head_attention=0, hyper_num_audio=50, hyper_num_text=30, hyper_num_video=20, hyper_tau=0.5, hyper_topk=3, hyper_update_freq=5, is_training=1, itr=1, k=3, kappa=0.0, label_map=7, learning_rate=0.003, loss_lambda=0.1, loss_mode='bce', num_classes=7, num_ordinal_levels=7, num_workers=8, patience=3, pkl_path='./preprocess/mosi_all_feat.pkl', reg_huber_delta=1.0, reg_loss_type='mae', reg_loss_weight=0.05, root_path='./datasets', seq_len_audio=500, seq_len_text=44, seq_len_video=32, setting_suffix='run4', task_mode='regression', train_epochs=10, use_attn_pooling=1, use_coral=0, use_gpu=True, use_head_ln=0, use_modal_gate=1, use_mosi_ecr=0, weight_decay=1e-05)
Use GPU: cuda
[Info] Number of parameters: 450050
[Info] Dataset: MOSI
[Info] Format: pkl
[Info] Task mode: regression
[Info] Loss: mae
[Info] Eval metrics: MAE / Corr / ACC7(report only)
[Info] MOSI ECR warm-up enabled: False
>>> Start training: MultimodalClassifier_multimodal_dm128_nc7_0_run4 >>>
[Info] Loading train data...
train 1284
[Info] train data loaded: 1284 samples
[Info] Loading val data...
val 229
[Info] val data loaded: 229 samples
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.2379 | Corr: 0.4295
[Info] Vali MAE: 1.2549 | Corr: 0.3511
Epoch: 1, Time: 9.70s | Train Loss: 0.8278020 Vali Loss: 0.8135256 Test Loss: 0.8412027 | Train MAE: 1.2613 Corr: 0.3108
Validation loss decreased (inf --> 0.813526).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.1344 | Corr: 0.5863
[Info] Vali MAE: 1.2886 | Corr: 0.5505
Epoch: 2, Time: 7.18s | Train Loss: 0.6143725 Vali Loss: 0.7209544 Test Loss: 0.8724847 | Train MAE: 1.0176 Corr: 0.5887
Validation loss decreased (0.813526 --> 0.720954).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0560 | Corr: 0.6162
[Info] Vali MAE: 1.0450 | Corr: 0.5762
Epoch: 3, Time: 7.10s | Train Loss: 0.6069828 Vali Loss: 0.6502858 Test Loss: 0.6396745 | Train MAE: 1.0038 Corr: 0.6385
Validation loss decreased (0.720954 --> 0.650286).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9915 | Corr: 0.6595
[Info] Vali MAE: 1.1010 | Corr: 0.6228
Epoch: 4, Time: 7.07s | Train Loss: 0.4792565 Vali Loss: 0.5932474 Test Loss: 0.6938931 | Train MAE: 0.8583 Corr: 0.7111
Validation loss decreased (0.650286 --> 0.593247).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9973 | Corr: 0.6129
[Info] Vali MAE: 1.0065 | Corr: 0.6134
Epoch: 5, Time: 7.08s | Train Loss: 0.4041739 Vali Loss: 0.6004759 Test Loss: 0.6148582 | Train MAE: 0.7621 Corr: 0.7623
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9857 | Corr: 0.6634
[Info] Vali MAE: 1.0513 | Corr: 0.6062
Epoch: 6, Time: 7.17s | Train Loss: 0.4265839 Vali Loss: 0.5827090 Test Loss: 0.6522326 | Train MAE: 0.7979 Corr: 0.7623
Validation loss decreased (0.593247 --> 0.582709).  Saving model ...
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 1.0414 | Corr: 0.6406
[Info] Vali MAE: 1.1228 | Corr: 0.6034
Epoch: 7, Time: 7.13s | Train Loss: 0.4100356 Vali Loss: 0.6414886 Test Loss: 0.7175810 | Train MAE: 0.7760 Corr: 0.7744
EarlyStopping counter: 1 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9989 | Corr: 0.6561
[Info] Vali MAE: 1.0164 | Corr: 0.6206
Epoch: 8, Time: 7.29s | Train Loss: 0.3688566 Vali Loss: 0.6075075 Test Loss: 0.6227630 | Train MAE: 0.7204 Corr: 0.7940
EarlyStopping counter: 2 out of 3
[Info] Processing batch 0/20
[Info] Processing batch 10/20
[Info] Vali MAE: 0.9912 | Corr: 0.6570
[Info] Vali MAE: 0.9885 | Corr: 0.6124
Epoch: 9, Time: 7.29s | Train Loss: 0.3344911 Vali Loss: 0.5996103 Test Loss: 0.6030948 | Train MAE: 0.6816 Corr: 0.8188
EarlyStopping counter: 3 out of 3
Early stopping
>>> Testing: MultimodalClassifier_multimodal_dm128_nc7_0_run4 <<<
[Info] Loading test data...
test 686
[Info] test data loaded: 686 samples
MAE: 1.0590
Corr: 0.6033
ACC7 (report only): 0.2959


/workspace/Ada-MSHyper/utils/metrics.py:28: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.abs((pred - true) / true))
/workspace/Ada-MSHyper/utils/metrics.py:32: RuntimeWarning: divide by zero encountered in divide
  return np.mean(np.square((pred - true) / true))

